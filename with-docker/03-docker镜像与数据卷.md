# 三.docker 镜像 与 容器数据卷

## docker 镜像

镜像什么?

镜像是一种轻量级,可执行的独立软件包,**用来打包软件运行环境和基于环境开发的软件**,它包含运行某个软件所需的所有内容,包括代码,运行时,库,环境变量和配置文件

**联合文件系统:对文件系统的修改作为一次提交来一层层的叠加,是 docker 镜像的基础,特性:一次同时加载多个文件系统,但从外面看起来,只能看到一个文件系统,联合加载会把各层文件系统叠加起来,这样最终的文件系统会包含所有底层的文件和目录**

docke 原理:底层使用宿主机的内核 kernel,自己只需要提供精简的 os,

镜像分层 — 共享资源

特点:

1. docker 镜像都是只读的
2. 当容器启动时,一个新的可写层被加载到镜像的顶部
3. 这一层通常被称作容器层,容器层之下的都叫镜像层

---

## docker commit

docker commit -m='提交信息的描述' -a='作者' 容器 ID 要创建的目标镜像名:[标签名]

例如:docker commit -a='gmk' -m='test' ce196d13ba08 gmk/mynginx:1.2

## 容器数据卷

是什么?将 docker 容器的数据持久化,当容器关闭后,将容器里的数据保存下来

**docker 的理念:将运用与运行的环境打包形成容器运行,运行可以伴随着容器,但是对数据的要求希望是持久化的,并且容器之间希望有可能共享数据**

能干嘛?

1. 容器的持久化
2. 容器间继承+共享数据

怎么添加?

1. 直接命令添加

   命令:docker run -it -v /宿主机绝对路径目录:/容器内目录 镜像名

   docker run -it -v Users/guo/work/myDataVolum:/home/dataVolumeContainer centos

   容器和宿主机之间数据共享

   容器停止退出后,主机修改后数据同步

   权限控制:

   命令:docker run -it -v /宿主机绝对路径目录:/容器内目录:ro 镜像名

2. DockerFile

   docker build -f /Users/guo/work/mydocker/Dockerfile -t gmk/centos1 .

## 数据卷容器

是什么?命名的容器挂载数据卷,其他容器通过挂载这个(父容器)实现数据共享,挂载数据卷的容器,称之为数据卷容器

docker run -it --name doc2 —volumes from doc1 gmk/mycnetos

结论:容器之间配置信息的传递,数据卷的生命周期一直持续到没有容器使用它为止
